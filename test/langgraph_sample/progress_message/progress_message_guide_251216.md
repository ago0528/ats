## 개요

- **요약**: Agent Flow 내 ‘계획/작업과정’ 기능을 추가하는 건에 대해 검토한 내용을 작성함
- **목적**
  - ‘작업과정’ tool을 추가하고, Agent가 Function Call하는 과정을 직접 확인하는 것을 통해
    - tool prompt 기획에 대한 감을 잡고
    - 디테일한 기획을 위한 의사결정 필요사항을 도출한다.

## 검토 결과

- Agent가 실행될 때마다 사용하는 ‘작업과정 생성 및 콜백용 툴'을 활용해서 ‘작업과정’ 제공 가능
- 프론트에서 작업과정 렌더링을 어떻게 할 것인지 방법 합의 필요
  - 예) 2초 간격 API Polling
  - 예) SSE를 통한 실시간 프/백 응답
- LLM 호출이 터졌을 때, 혹은 타임아웃됐을 때 폴백 전략 필요
- 각 Agent 시스템에 ‘작업과정 생성 툴’을 호출할 수 있도록 프롬프트 업데이트 필요
  - ## Tool Guideline
    작업 시작 시 report_progress 툴을 호출하여 사용자에게 알려주세요.
    예시:
    - 요청 분석 시작: report_progress({action: "ANALYZING_REQUEST"})
    - 시나리오 검색 시작: report_progress({action: "SEARCHING_SCENARIO", context: {keyword: "수상시"}})
    - UI 생성 시작: report_progress({action: "GENERATING_UI"})

## 정책

### 요약

| **항목**     | **결정**                                                                           |
| ------------ | ---------------------------------------------------------------------------------- |
| 노출 조건    | 1) 예상 소요시간 5초 이상, 2) 호출하는 에이전트가 2개 이상                         |
| 호출 시점    | 모든 에이전트가 사용하는 Tool로 설정 → 단, 에이전트 프롬프팅을 통해 호출 빈도 조절 |
| 메시지 형식  | 제목(15자) + 설명(1~3문장) 구조                                                    |
| 툴 사용 정보 | • 사용자 요청: {user_request}                                                      |

• 호출 툴: {tool_name}
• 툴 설명: {tool_description}
• 툴 파라미터: {tool_params} |
| 생성 방식 | (기본) LLM 동적 생성 기본 → (폴백) 정적 매핑 |
| 실행 방식 | 메인 Agent Flow와 병렬 비동기 실행 |

### 구체

- **작업과정 툴 노출 조건**
  - **조건**: 1) 예상 소요시간 5초 이상, 2) 호출하는 에이전트가 2개 이상
  - **방법**: 예상 소요시간, 호출 에이전트 개수는 Orchestrator Agent를 통해 도출
  - **예상**: 주로 ‘분석 에이전트’에서 돌게 될 것으로 예상
- **툴 호출 시점**
  - 모든 에이전트가 호출하는 형태 → 이에 따른 에이전트별 프롬프트 수정 필요
  - 처음 동작하는 에이전트(Orcestrator)의 경우, 간헐적으로 판단 하에 동작할 수 있도록 프롬프팅 고려
- **사용자에게 (UI로) 제공할 정보**
  - **정보:** 진행과정의 ‘제목, 설명’
    - 진행과정 제목 예) 요청 분석 중
    - 진행과정 설명 예) 사용자의 채용 공고 생성 요청을 분석하고 있습니다. <br> 공개 채용 형태로 생성하려고 합니다.
  - **사용성 제언**
    - 프론트에서 줄바꿈 처리가 적절히 될 수 있도록 '<br> 태그가 박힌 경우 개행 처리'와 같은 정책 고려 가능한지?
- **진행과정 LLM 생성 실패시(폴백 전략)**
  - 기존처럼 정적 매핑하는 형태로 처리

## 진행과정 Tool Prompt

- 진행과정이 정렬되는 순서(Order)는 내려줄 필요 없을까?

```
## Role
사용자에게 현재 AI Agent의 작업 진행 상황을 설명하는 메시지를 생성합니다.

## Input
- 사용자 요청: {user_request}
- 호출 툴: {tool_name}
- 툴 설명: {tool_description}
- 툴 파라미터: {tool_params}

## Output Format
title: [작업 단계를 나타내는 명사형 제목, 15자 내외]
description: [현재 수행 중인 작업을 1~3문장으로 설명. tool_params의 구체적 값을 자연스럽게 포함]

## Guidelines
- title은 "~중", "~ 확인" 형태의 명사형
- description은 "~하고 있습니다" 형태
- tool_params에 있는 키워드, ID, 이름 등을 description에 자연스럽게 녹여서 구체성 확보
- 기술 용어는 사용자 친화적으로 변환 (예: "url_tracker" → "제공할 페이지 찾는 중")

## Example
Input:
- user_request: "기존 채용을 불러오고 싶어"
- tool_name: "url_tracker"
- tool_params: {plnaId: "1234", dataKey: [""}

Output:
title: 요청 분석 중
description: 사용자의 채용 공고 생성 요청을 분석하고 있습니다. <br>
공개 채용 형태로 생성하려고 합니다.

```
